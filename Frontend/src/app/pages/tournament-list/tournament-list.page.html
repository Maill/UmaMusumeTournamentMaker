<div class="tournament-list-page">
  <!-- Page Header -->
  <div class="page-header">
    <div class="header-content">
      <div class="header-info">
        <h1 class="page-title">
          <app-icon name="trophy" size="xl" color="primary" ariaLabel="Tournaments"> </app-icon>
          Manage and participate in competitive tournaments
        </h1>
        <p class="page-subtitle">Matches format are 1v1v1, like Champions Meeting.</p>
        <p class="page-subtitle">
          Decide which track competition will occurs with which conditions and play!
        </p>
        <p class="page-subtitle">May the best trainer win!</p>
      </div>

      <div class="header-actions">
        <app-button variant="primary" size="lg" (clicked)="onCreateTournament()">
          <!--<app-icon name="add" size="sm"> </app-icon>-->
          Create Tournament
        </app-button>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <div class="page-content">
    <!-- Loading State with Skeletons -->
    @if (state.isLoading && !state.hasLoaded) {
    <div class="tournaments-section">
      <div class="tournaments-grid">
        @for (i of [1,2,3,4,5,6]; track i) {
        <app-tournament-card-skeleton></app-tournament-card-skeleton>
        }
      </div>
    </div>
    }

    <!-- Error State -->
    @if (state.error && !state.isLoading) {
    <div class="error-section">
      <app-error-display
        [message]="state.error"
        type="error"
        [retryable]="true"
        retryText="Retry Loading"
        title="Failed to Load Tournaments"
        (retryClicked)="loadTournaments()"
        (dismissed)="clearError()"
      >
      </app-error-display>
    </div>
    }

    <!-- Tournaments Grid -->
    @if (!state.isLoading && !state.error && state.tournaments.length > 0) {
    <div class="tournaments-section">
      <!-- Tournament Stats - Deferred for better LCP -->
      @defer (on viewport) {
      <div class="tournaments-stats">
        <div class="stat-card">
          <app-icon name="trophy" size="lg" color="primary"></app-icon>
          <div class="stat-content">
            <span class="stat-value">{{ state.tournaments.length }}</span>
            <span class="stat-label">Total Tournaments</span>
          </div>
        </div>

        <div class="stat-card">
          <app-icon name="play" size="md" color="success"></app-icon>
          <div class="stat-content">
            <span class="stat-value">{{ getActiveTournamentsCount() }}</span>
            <span class="stat-label">Active</span>
          </div>
        </div>

        <div class="stat-card">
          <app-icon name="check" size="md" color="warning"></app-icon>
          <div class="stat-content">
            <span class="stat-value">{{ getCompletedTournamentsCount() }}</span>
            <span class="stat-label">Completed</span>
          </div>
        </div>
      </div>
      } @placeholder {
      <div
        class="tournaments-stats-placeholder"
        style="height: 120px; background: #f8f9fa; border-radius: 8px; margin-bottom: 2rem"
      ></div>
      }

      <!-- Filter/Sort Options -->
      <div class="tournaments-filters">
        <div class="filter-info">
          <span class="results-count">
            Showing {{ getFilteredTournaments().length }} tournaments
          </span>
        </div>

        <div class="filter-actions">
          <app-button
            variant="outline-secondary"
            size="sm"
            [loading]="state.isLoading"
            (clicked)="refreshTournaments()"
          >
            <app-icon name="refresh" size="xs"></app-icon>
            Refresh
          </app-button>
        </div>
      </div>

      <!-- Tournaments Grid -->
      <div class="tournaments-grid">
        @for (tournament of getFilteredTournaments(); track tournament.id) {
        <app-tournament-card
          [tournament]="mapToCardData(tournament)"
          [clickable]="true"
          [showActions]="true"
          (cardClicked)="onTournamentClick($event)"
        >
        </app-tournament-card>
        }
      </div>
    </div>
    }

    <!-- Empty State -->
    @if (!state.isLoading && !state.error && state.tournaments.length === 0 && state.hasLoaded) {
    <div class="empty-state">
      <div class="empty-content">
        <app-icon name="trophy" size="xxl" color="secondary" ariaLabel="No tournaments"> </app-icon>
        <h2>No Tournaments Found</h2>
        <p>
          You haven't created any tournaments yet. Get started by creating your first tournament!
        </p>

        <div class="empty-actions">
          <app-button variant="primary" size="lg" (clicked)="onCreateTournament()">
            <!--<app-icon name="add" size="sm"> </app-icon>-->
            Create Your First Tournament
          </app-button>
        </div>
      </div>
    </div>
    }
  </div>
</div>
